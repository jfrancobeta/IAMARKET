<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <div class="card shadow">
        <div class="card-header text-center">
          <h2>Crear Cuenta</h2>
          <p class="text-muted">Únete a la plataforma de IA más grande</p>
        </div>
        <div class="card-body">
          <!-- Datos generales del usuario -->
          <form
            id="userForm"
            (ngSubmit)="onsubmit(userForm)"
            #userForm="ngForm"
          >
            <div class="row mb-3">
              <div class="col-md-6">
                <label for="nombre" class="form-label">Nombre completo</label>
                <input
                  type="text"
                  class="form-control"
                  id="nombre"
                  name="nombre"
                  #name="ngModel"
                  [(ngModel)]="registroRequest.nombre"
                  required
                />
                <div
                  *ngIf="name.invalid && name.touched"
                  class="text-danger small"
                >
                  El nombre es obligatorio.
                </div>
              </div>
              <div class="col-md-6">
                <label for="username" class="form-label"
                  >Nombre de usuario</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="username"
                  name="username"
                  [(ngModel)]="registroRequest.username"
                  #username="ngModel"
                  required
                />
                <div
                  *ngIf="username.invalid && username.touched"
                  class="text-danger small"
                >
                  El nombre de usuario es obligatorio.
                </div>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-6">
                <label for="email" class="form-label">Correo electrónico</label>
                <input
                  type="email"
                  class="form-control"
                  id="email"
                  name="email"
                  [(ngModel)]="registroRequest.email"
                  #email="ngModel"
                  required
                  email
                />
                <div
                  *ngIf="email.invalid && email.touched"
                  class="text-danger small"
                >
                  <span *ngIf="email.errors?.['required']"
                    >El correo electrónico es obligatorio.</span
                  >
                  <span *ngIf="email.errors?.['email']"
                    >El formato del correo no es válido.</span
                  >
                </div>
              </div>
              <div class="col-md-6">
                <label for="password" class="form-label">Contraseña</label>
                <input
                  type="password"
                  class="form-control"
                  id="password"
                  name="password"
                  [(ngModel)]="registroRequest.password"
                  #password="ngModel"
                  required
                  minlength="6"
                />
                <div
                  *ngIf="password.invalid && password.touched"
                  class="text-danger small"
                >
                  <span *ngIf="password.errors?.['required']"
                    >La contraseña es obligatoria.</span
                  >
                  <span *ngIf="password.errors?.['minlength']"
                    >La contraseña debe tener al menos 6 caracteres.</span
                  >
                </div>
              </div>
              <div class="col-md-6">
                <label for="pais" class="form-label">País</label>
                <select
                  class="form-select"
                  id="pais"
                  name="pais"
                  [(ngModel)]="registroRequest.pais"
                  #pais="ngModel"
                  required
                >
                  <option selected disabled value="">Selecciona un país</option>
                  <option *ngFor="let pais of paises" [value]="pais.id">
                    {{ pais.nombre }}
                  </option>
                </select>
                <div
                  *ngIf="pais.invalid && pais.touched"
                  class="text-danger small"
                >
                  Selecciona un país.
                </div>
              </div>
            </div>

            <!-- Tabs para rol específico -->
            <ul class="nav nav-tabs mb-4" id="registerTabs" role="tablist">
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link active"
                  id="company-tab"
                  type="button"
                  [class.active]="registroRequest.userType === 0"
                  (click)="registroRequest.userType = 0"
                >
                  Empresa
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link"
                  type="button"
                  [class.active]="registroRequest.userType === 1"
                  (click)="registroRequest.userType = 1"
                >
                  Desarrollador
                </button>
              </li>
            </ul>

            <!-- Empresa -->
            <div *ngIf="registroRequest.userType === 0">
              <div
                class="tab-pane fade show active"
                id="company"
                role="tabpanel"
              >
                <div class="row mb-3">
                  <div class="col-md-6">
                    <label for="company-name" class="form-label"
                      >Nombre de la empresa</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="company-name"
                      name="nombreCompania"
                      [(ngModel)]="registroRequest.nombreCompania"
                      #nombreCompania="ngModel"
                      required
                    />
                    <div
                      *ngIf="nombreCompania.invalid && nombreCompania.touched"
                      class="text-danger small"
                    >
                      El nombre de la empresa es obligatorio.
                    </div>
                  </div>
                  <div class="col-md-6">
                    <label for="industria" class="form-label">Industria</label>
                    <select
                      class="form-select"
                      id="industria"
                      name="industria"
                      [(ngModel)]="registroRequest.industria"
                      #industria="ngModel"
                      required
                    >
                      <option selected disabled value="">
                        Selecciona un sector
                      </option>
                      <option
                        *ngFor="let industria of industrias"
                        [value]="industria.id"
                      >
                        {{ industria.nombre }}
                      </option>
                    </select>
                    <div
                      *ngIf="industria.invalid && industria.touched"
                      class="text-danger small"
                    >
                      Selecciona un sector.
                    </div>
                  </div>
                </div>

                <div class="row mb-3">
                  <div class="col-md-6">
                    <label for="website" class="form-label">Sitio web</label>
                    <input
                      type="url"
                      class="form-control"
                      id="website"
                      name="website"
                      [(ngModel)]="registroRequest.website"
                      #website="ngModel"
                      placeholder="https://www.miempresa.com"
                    />
                    <div
                      *ngIf="website.invalid && website.touched"
                      class="text-danger small"
                    >
                      Ingresa una URL válida.
                    </div>
                  </div>
                </div>

                <div class="mb-3">
                  <label for="company-description" class="form-label"
                    >Descripción</label
                  >
                  <textarea
                    class="form-control"
                    id="company-description"
                    rows="3"
                    placeholder="Describe tu empresa..."
                    name="descripcion"
                    [(ngModel)]="registroRequest.descripcion"
                    #descripcion="ngModel"
                  ></textarea>
                  <div
                    *ngIf="descripcion.invalid && descripcion.touched"
                    class="text-danger small"
                  >
                    La descripción es obligatoria.
                  </div>
                </div>
              </div>
            </div>

            <!-- Desarrollador -->
            <div *ngIf="registroRequest.userType === 1">
              <div class="row mb-3">
                <div class="col-md-6">
                  <label class="form-label">Habilidades principales</label>
                  <div class="mb-2 d-flex flex-wrap">
                    <span
                      *ngFor="let skill of selectedHabilidades"
                      class="badge bg-primary me-1 mb-1"
                    >
                      {{ skill.nombre }}
                      <button
                        type="button"
                        class="btn-close btn-close-white btn-sm ms-1"
                        aria-label="Eliminar"
                        (click)="removeSkill(skill)"
                      ></button>
                    </span>
                  </div>
                  <button
                    type="button"
                    class="btn btn-outline-secondary btn-sm"
                    data-bs-toggle="modal"
                    data-bs-target="#habilidadesModal"
                  >
                    Seleccionar habilidades
                  </button>
                  <div
                    *ngIf="selectedHabilidades.length === 0"
                    class="text-danger small"
                  >
                    Las habilidades son obligatorias.
                  </div>
                </div>

                <div class="col-md-6">
                  <label for="experience" class="form-label">Experiencia</label>
                  <select
                    class="form-select"
                    id="experience"
                    name="experiencia"
                    [(ngModel)]="registroRequest.experiencia"
                    #experiencia="ngModel"
                    required
                  >
                    <option selected disabled>Años de experiencia</option>
                    <option value="1">1 años</option>
                    <option value="3">3 años</option>
                    <option value="5">5 años</option>
                    <option value="10">10 años</option>
                    <option value="10+">Más de 10 años</option>
                  </select>
                  <div
                    *ngIf="experiencia.invalid && experiencia.touched"
                    class="text-danger small"
                  >
                    Selecciona la experiencia.
                  </div>
                </div>
              </div>

              <div class="mb-3">
                <label for="portfolio" class="form-label"
                  >Portafolio / GitHub</label
                >
                <input
                  type="url"
                  class="form-control"
                  id="portfolio"
                  name="portafolioURL"
                  [(ngModel)]="registroRequest.portafolioURL"
                  #portafolioURL="ngModel"
                  placeholder="https://github.com/usuario"
                />
                <div
                  *ngIf="portafolioURL.invalid && portafolioURL.touched"
                  class="text-danger small"
                >
                  Ingresa una URL válida de portafolio.
                </div>
              </div>
            </div>

            <button type="submit" class="btn btn-primary w-100">
              Crear Cuenta
            </button>
          </form>
          <div class="text-center mt-4">
            <p class="text-muted">
              ¿Ya tienes cuenta?
              <a routerLink="/auth" class="text-primary">Inicia sesión aquí</a>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div
  class="modal fade"
  id="habilidadesModal"
  tabindex="-1"
  aria-labelledby="habilidadesModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="habilidadesModalLabel">Selecciona tus habilidades</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
        <div *ngFor="let skill of habilidadesList" class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            [id]="'skill-' + skill.id"
            [value]="skill.id"
            [(ngModel)]="skill.checked"
          />
          <label class="form-check-label" [for]="'skill-' + skill.id">
            {{ skill.nombre }}
          </label>
        </div>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-primary"
          data-bs-dismiss="modal"
          (click)="confirmSkills()"
        >
          Confirmar
        </button>
      </div>
    </div>
  </div>
</div>