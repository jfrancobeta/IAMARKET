<app-main-layout>
  <div class="container py-4">
    <a
      [routerLink]="['/solutions']"
      class="btn btn-outline-secondary btn-sm mb-4 d-flex align-items-center"
    >
      <i class="bi bi-arrow-left me-2"></i>
      Volver a Soluciones
    </a>

    <div *ngIf="isOwner" class="mb-3 d-flex gap-2">
      <a
        [routerLink]="['/solutions/edit', SolucionDTO.id]"
        class="btn btn-warning btn-sm"
      >
        <i class="bi bi-pencil"></i> Editar
      </a>
      <button class="btn btn-danger btn-sm" (click)="onDelete()">
        <i class="bi bi-trash"></i> Eliminar
      </button>
    </div>
    <div class="row g-4">
      <!-- Main Content -->
      <div class="col-lg-8">
        <div class="card mb-4">
          <div class="card-header">
            <div class="d-flex align-items-center gap-2 mb-2">
              <span class="badge bg-primary">{{
                SolucionDTO.estado.nombre
              }}</span>
              <span class="badge bg-light text-dark border">{{
                SolucionDTO.categoria.nombre
              }}</span>
            </div>
            <h2 class="fw-bold fs-4 mb-1">{{ SolucionDTO.titulo }}</h2>
            <p class="text-muted mb-2">
              {{ SolucionDTO.descripcion }}
            </p>
          </div>
          <div class="card-body">
            <div class="row g-4 mb-4">
              <div class="col-md-3 d-flex align-items-center gap-2">
                <i class="bi bi-currency-dollar text-success fs-5"></i>
                <div>
                  <div class="fw-medium">${{ SolucionDTO.precio }}</div>
                  <div class="text-muted small">Precio fijo</div>
                </div>
              </div>
              <div class="col-md-3 d-flex align-items-center gap-2">
                <i class="bi bi-clock text-primary fs-5"></i>
                <div>
                  <div class="fw-medium">
                    {{ SolucionDTO.tiempoEntrega }}
                    {{ SolucionDTO.unidadEntrega }}
                  </div>
                  <div class="text-muted small">Entrega</div>
                </div>
              </div>
              <div class="col-md-3 d-flex align-items-center gap-2">
                <i class="bi bi-eye text-purple fs-5"></i>
                <div>
                  <div class="fw-medium">{{ SolucionDTO.vistas }}</div>
                  <div class="text-muted small">Vistas</div>
                </div>
              </div>
              <div class="col-md-3 d-flex align-items-center gap-2">
                <i class="bi bi-cart text-orange fs-5"></i>
                <div>
                  <div class="fw-medium">{{ SolucionDTO.pedidos }}</div>
                  <div class="text-muted small">Pedidos</div>
                </div>
              </div>
            </div>
            <hr />
            <h5 class="fw-semibold mb-2">Tecnologías Utilizadas</h5>
            <div class="d-flex flex-wrap gap-2 mb-4">
              @for (item of SolucionDTO.habilidades; track $index) {
              <span class="badge bg-secondary">{{ item.nombre }}</span>
              }
            </div>
          </div>
        </div>

        <!-- Tabs -->
        <ul class="nav nav-tabs mb-3" id="solutionTabs" role="tablist">
          <li class="nav-item" role="presentation">
            <button
              class="nav-link active"
              id="features-tab"
              data-bs-toggle="tab"
              data-bs-target="#features"
              type="button"
              role="tab"
            >
              Características
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="milestones-tab"
              data-bs-toggle="tab"
              data-bs-target="#milestones"
              type="button"
              role="tab"
            >
              Hitos
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="requirements-tab"
              data-bs-toggle="tab"
              data-bs-target="#requirements"
              type="button"
              role="tab"
            >
              Requisitos
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="portfolio-tab"
              data-bs-toggle="tab"
              data-bs-target="#portfolio"
              type="button"
              role="tab"
            >
              Portafolio
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="reviews-tab"
              data-bs-toggle="tab"
              data-bs-target="#reviews"
              type="button"
              role="tab"
            >
              Reseñas
            </button>
          </li>
        </ul>
        <div class="tab-content" id="solutionTabsContent">
          <!-- Características -->
          <div class="tab-pane fade show active" id="features" role="tabpanel">
            <div class="card mb-4">
              <div class="card-header">
                <h5 class="fw-bold mb-1">¿Qué incluye esta solución?</h5>
              </div>
              <div class="card-body">
                <ul class="list-unstyled mb-0">
                  @for (caracteristica of SolucionDTO.caracteristicas; track
                  $index) {
                  <li class="d-flex align-items-start gap-2 mb-2">
                    <i class="bi bi-check-circle text-success me-2"></i
                    >{{ caracteristica }}
                  </li>
                  }
                </ul>
              </div>
            </div>
          </div>
          <div class="tab-pane fade" id="milestones" role="tabpanel">
            <div class="card mb-4">
              <div class="card-header">
                <h5 class="mb-1">Cronograma de Entrega</h5>
                <p class="text-muted mb-0">
                  Hitos y entregables organizados por fases
                </p>
              </div>
              <div class="card-body">
                <div
                  *ngFor="let hito of SolucionDTO.hitos; let i = index"
                  class="border rounded-lg p-4 mb-4"
                >
                  <div
                    class="d-flex justify-content-between align-items-start mb-2"
                  >
                    <div class="d-flex align-items-center gap-2">
                      <div
                        class="d-flex align-items-center justify-content-center rounded-circle bg-primary bg-opacity-10 text-primary"
                        style="width: 2rem; height: 2rem; font-weight: 600"
                      >
                        {{ i + 1 }}
                      </div>
                      <h4 class="fw-semibold mb-0">{{ hito.nombre }}</h4>
                    </div>
                    <div
                      class="d-flex align-items-center gap-2 small text-muted"
                    >
                      <i class="bi bi-clock"></i>
                      <span>
                        {{
                          hito.fechaEntrega | date : "yyyy-MM-dd"
                        }}
                      </span>
                    </div>
                  </div>
                  <p class="text-muted small mb-3 ms-5">
                    {{ hito.descripcion }}
                  </p>
                  <div class="ms-5">
                    <h6 class="small fw-medium mb-2">Entregables:</h6>
                    <ul class="list-unstyled mb-0">
                      <li
                        *ngFor="let entregable of hito.entregables"
                        class="d-flex align-items-center gap-2 small text-muted"
                      >
                        <i class="bi bi-check-circle text-success"></i>
                        {{ entregable.nombreArchivo || entregable }}
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Requisitos -->
          <div class="tab-pane fade" id="requirements" role="tabpanel">
            <div class="card mb-4">
              <div class="card-header">
                <h5 class="fw-bold mb-1">¿Qué necesitas proporcionar?</h5>
                <p class="text-muted mb-0">
                  Requisitos para implementar esta solución
                </p>
              </div>
              <div class="card-body">
                <ul class="list-unstyled mb-0">
                  @for (requisito of SolucionDTO.requisitos; track $index) {
                  <li class="d-flex align-items-start gap-2 mb-2">
                    <i class="bi bi-check-circle text-success me-2"></i
                    >{{ requisito }}
                  </li>
                  }
                </ul>
              </div>
            </div>
          </div>
          <!-- Portafolio -->
          <div class="tab-pane fade" id="portfolio" role="tabpanel">
            <div class="row g-4">
              <div class="col-md-6">
                <div class="card">
                  <img
                    src="/placeholder.svg?height=200&width=300"
                    class="card-img-top"
                    alt="E-commerce Fashion"
                  />
                  <div class="card-body">
                    <h5 class="card-title">E-commerce Fashion</h5>
                    <p class="card-text text-muted">
                      Sistema implementado para tienda de moda online
                    </p>
                    <span class="badge bg-success"
                      >+35% en ventas cruzadas</span
                    >
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="card">
                  <img
                    src="/placeholder.svg?height=200&width=300"
                    class="card-img-top"
                    alt="Marketplace Tech"
                  />
                  <div class="card-body">
                    <h5 class="card-title">Marketplace Tech</h5>
                    <p class="card-text text-muted">
                      Recomendaciones para marketplace de tecnología
                    </p>
                    <span class="badge bg-success">+28% en conversión</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Reseñas -->
          <div class="tab-pane fade" id="reviews" role="tabpanel">
            <div class="card mb-3">
              <div class="card-body d-flex gap-4">
                <img
                  src="/placeholder.svg?height=40&width=40"
                  class="rounded-circle"
                  width="40"
                  height="40"
                  alt="TechStore"
                />
                <div class="flex-grow-1">
                  <div class="d-flex justify-content-between mb-2">
                    <div>
                      <h4 class="fw-semibold mb-0">TechStore</h4>
                      <div>
                        <i class="bi bi-star-fill text-warning"></i>
                        <i class="bi bi-star-fill text-warning"></i>
                        <i class="bi bi-star-fill text-warning"></i>
                        <i class="bi bi-star-fill text-warning"></i>
                        <i class="bi bi-star-fill text-warning"></i>
                      </div>
                    </div>
                    <span class="text-sm text-muted">20/01/2024</span>
                  </div>
                  <p class="text-muted mb-3">
                    Excelente sistema de recomendaciones. Implementación
                    perfecta y resultados inmediatos. Muy recomendado.
                  </p>
                  <button class="btn btn-link p-0 text-decoration-none">
                    <i class="bi bi-hand-thumbs-up me-1"></i>8 personas
                    encontraron esto útil
                  </button>
                </div>
              </div>
            </div>
            <div class="card mb-3">
              <div class="card-body d-flex gap-4">
                <img
                  src="/placeholder.svg?height=40&width=40"
                  class="rounded-circle"
                  width="40"
                  height="40"
                  alt="FashionHub"
                />
                <div class="flex-grow-1">
                  <div class="d-flex justify-content-between mb-2">
                    <div>
                      <h4 class="fw-semibold mb-0">FashionHub</h4>
                      <div>
                        <i class="bi bi-star-fill text-warning"></i>
                        <i class="bi bi-star-fill text-warning"></i>
                        <i class="bi bi-star-fill text-warning"></i>
                        <i class="bi bi-star-fill text-warning"></i>
                        <i class="bi bi-star-fill text-warning"></i>
                      </div>
                    </div>
                    <span class="text-sm text-muted">15/01/2024</span>
                  </div>
                  <p class="text-muted mb-3">
                    Ana superó nuestras expectativas. El sistema funciona
                    perfectamente y el soporte post-venta es excelente.
                  </p>
                  <button class="btn btn-link p-0 text-decoration-none">
                    <i class="bi bi-hand-thumbs-up me-1"></i>12 personas
                    encontraron esto útil
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Sidebar -->
      <div class="col-lg-4">
        <!-- Purchase Card -->
        <div class="card mb-4">
          <div class="card-body text-center">
            <p class="h3 fw-bold mb-1">
              ${{ SolucionDTO.precio | number : "1.0-0" }}
            </p>
            <p class="text-muted mb-3">Precio fijo</p>
            <a
              href="#"
              class="btn btn-primary w-100 mb-2 d-flex align-items-center justify-content-center"
            >
              <i class="bi bi-cart me-2"></i>
              Comprar Ahora
            </a>
            <a
              href="#"
              class="btn btn-outline-secondary w-100 d-flex align-items-center justify-content-center"
            >
              <i class="bi bi-chat-dots me-2"></i>
              Contactar Vendedor
            </a>
          </div>
        </div>
        <!-- Developer Info -->
        <div class="card mb-4">
          <div class="card-header">
            <h5 class="fw-bold mb-1">Sobre el Desarrollador</h5>
          </div>
          <div class="card-body">
            <div class="d-flex align-items-center gap-3 mb-3">
              <img
                src="{{ SolucionDTO.desarrollador.foto }}"
                class="rounded-circle"
                width="40"
                height="40"
                alt="Ana García"
              />
              <div>
                <h6 class="fw-semibold mb-0">
                  {{ SolucionDTO.desarrollador.nombre }}
                </h6>
                <div class="d-flex align-items-center gap-1">
                  <i class="bi bi-star-fill text-warning"></i>
                  <i class="bi bi-star-fill text-warning"></i>
                  <i class="bi bi-star-fill text-warning"></i>
                  <i class="bi bi-star-fill text-warning"></i>
                  <i class="bi bi-star-fill text-warning"></i>
                  <span class="text-sm text-muted ms-1"
                    >4.9 (45 proyectos)</span
                  >
                </div>
              </div>
            </div>
            <div class="mb-2 d-flex justify-content-between">
              <span class="text-muted">Tiempo de respuesta:</span>
              <span class="fw-medium">2 horas</span>
            </div>
            <div class="mb-2 d-flex justify-content-between">
              <span class="text-muted">Tasa de éxito:</span>
              <span class="fw-medium">100%</span>
            </div>
            <div class="mb-2 d-flex justify-content-between">
              <span class="text-muted">Miembro desde:</span>
              <span class="fw-medium">{{
                SolucionDTO.desarrollador.fechaCreacion | date : "yyyy-MM-dd"
              }}</span>
            </div>
            <a
              [routerLink]="['/details-user', 'Ana García']"
              routerLinkActive="router-link-active"
              class="btn btn-outline-secondary w-100 mt-3"
              >Ver Perfil Completo</a
            >
          </div>
        </div>
        <!-- Stats -->
        <div class="card mb-4">
          <div class="card-header">
            <h5 class="fw-bold mb-1">Estadísticas</h5>
          </div>
          <div class="card-body">
            <div class="mb-2 d-flex justify-content-between">
              <span class="text-muted">Vistas totales:</span>
              <span class="fw-medium">156</span>
            </div>
            <div class="mb-2 d-flex justify-content-between">
              <span class="text-muted">Pedidos completados:</span>
              <span class="fw-medium">8</span>
            </div>
            <div class="mb-2 d-flex justify-content-between">
              <span class="text-muted">Calificación promedio:</span>
              <div class="d-flex align-items-center gap-1">
                <span class="fw-medium">4.9</span>
                <i class="bi bi-star-fill text-warning"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</app-main-layout>
